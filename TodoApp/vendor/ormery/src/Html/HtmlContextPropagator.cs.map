{ "version": 3, "file": "csharp/ormery/src/Html/HtmlContextPropagator.cs", "sources": [ "-work/src/html/safe-html-transition-tables.temper.md" ], "sourcesContent": [ "# Transition tables for Safe HTML\n\nThe transition tables are defined in `./safe-html.temper.md` but the code generated from them lives here.\n\n\u003cdetails\u003e\u003csummary\u003eGenerated propagation functions\u003c/summary\u003e\n\n\u003c!-- GENERATED_PROPAGATION_FN: Html --\u003e\n\n    let htmlStateStr(x: Int32): String {\n      when (x) {\n        htmlStatePcdata -\u003e \u0022Pcdata\u0022;\n        htmlStateOName -\u003e \u0022OName\u0022;\n        htmlStateCName -\u003e \u0022CName\u0022;\n        htmlStateBeforeAttr -\u003e \u0022BeforeAttr\u0022;\n        htmlStateBeforeEq -\u003e \u0022BeforeEq\u0022;\n        htmlStateBeforeValue -\u003e \u0022BeforeValue\u0022;\n        htmlStateAttr -\u003e \u0022Attr\u0022;\n        htmlStateAfterAttr -\u003e \u0022AfterAttr\u0022;\n        htmlStateSpecialBody -\u003e \u0022SpecialBody\u0022;\n        else -\u003e x.toString();\n      }\n    }\n    let tagStateStr(x: Int32): String {\n      when (x) {\n        else -\u003e x.toString();\n      }\n    }\n    let attribStateStr(x: Int32): String {\n      when (x) {\n        attribStateGeneric -\u003e \u0022Generic\u0022;\n        attribStateCss -\u003e \u0022Css\u0022;\n        attribStateJs -\u003e \u0022Js\u0022;\n        attribStateUrl -\u003e \u0022Url\u0022;\n        attribStateUrls -\u003e \u0022Urls\u0022;\n        else -\u003e x.toString();\n      }\n    }\n    let delimStateStr(x: Int32): String {\n      when (x) {\n        delimStateUq -\u003e \u0022Uq\u0022;\n        delimStateSq -\u003e \u0022Sq\u0022;\n        delimStateDq -\u003e \u0022Dq\u0022;\n        else -\u003e x.toString();\n      }\n    }\n    let htmlPropagateContext(\n      before: AutoescState\u003cHtmlEscaperContext\u003e,\n      literalPart: String?,\n    ): AfterPropagate\u003cHtmlEscaperContext\u003e {\n      let contextBefore = before.context;\n      let pattern0: Regex = rgx'^(?:\u0022)';\n      let pattern1: Regex = rgx'^(?:\u0022[^\u0022]*\u0022?)';\n      let pattern2: Regex = rgx\u0022^(?:')\u0022;\n      let pattern3: Regex = rgx\u0022^(?:'[^']*'?)\u0022;\n      let pattern4: Regex = rgx\u0022^(?:(?:\u003e))\u0022;\n      let pattern5: Regex = rgx\u0022^(?:(?:[\u003e\\t\\r\\n ]))\u0022;\n      let pattern6: Regex = rgx\u0022^(?:(?:[A-Za-z0-9:-:-]))\u0022;\n      let pattern7: Regex = rgx\u0022^(?:(?:[Ss][Rr][Cc][Ss][Ee][Tt]))\u0022;\n      let pattern8: Regex = rgx\u0022^(?:(?:[Ss][Rr][Cc]|[Hh][Rr][Ee][Ff]))\u0022;\n      let pattern9: Regex = rgx\u0022^(?:(?:[\\t\\r\\n ]*/?\u003e))\u0022;\n      let pattern10: Regex = rgx\u0022^(?:(?:[^\u003e\\t\\r\\n ]))\u0022;\n      let pattern11: Regex = rgx\u0022^(?:(?:[a-zA-Z]))\u0022;\n      let pattern12: Regex = rgx\u0022^(?:,)\u0022;\n      let pattern13: Regex = rgx\u0022^(?:\u003c)\u0022;\n      let pattern14: Regex = rgx\u0022^(?:\u003c/)\u0022;\n      let pattern15: Regex = rgx\u0022^(?:=)\u0022;\n      let pattern16: Regex = rgx\u0022^(?:\u003e)\u0022;\n      let pattern17: Regex = rgx\u0022^(?:[Dd][Aa][Tt][Aa]-[^=\\t\\r\\n \u003e]*[Uu][Rr][LlIi][^=\\t\\r\\n \u003e]*)\u0022;\n      let pattern18: Regex = rgx\u0022^(?:[Oo][Nn][^=\\t\\r\\n \u003e]*)\u0022;\n      let pattern19: Regex = rgx\u0022^(?:[Ss][Tt][Yy][Ll][Ee])\u0022;\n      let pattern20: Regex = rgx\u0022^(?:[\\t\\r\\n ]+)\u0022;\n      let pattern21: Regex = rgx'^(?:[^\u0022]+)';\n      let pattern22: Regex = rgx\u0022^(?:[^']+)\u0022;\n      let pattern23: Regex = rgx\u0022^(?:[^\u003c\u003e]+)\u0022;\n      let pattern24: Regex = rgx\u0022^(?:[^=\u003e\\t\\r\\n ]+)\u0022;\n      let pattern25: Regex = rgx'^(?:[^\u003e\\t\\r\\n \u0022]+)';\n      let pattern26: Regex = rgx\u0022^(?:[^\u003e])\u0022;\n      let pattern27: Regex = rgx\u0022^(?:[a-zA-Z0-9-]+:)\u0022;\n      let pattern28: Regex = rgx\u0022^(?:[a-zA-Z][a-zA-Z0-9:-:-]*)\u0022;\n      if (literalPart != null) {\n        if (contextBefore.htmlState == htmlStatePcdata) {\n          let match: Match? = pattern14.find(literalPart) orelse null;\n          if (match != null) {\n            if ((pattern11.find(literalPart.slice(match.full.end, literalPart.end)) orelse null) != null) {\n              return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n                match.full.value,\n                match.full.end,\n                new AutoescState\u003cHtmlEscaperContext\u003e(\n                  new HtmlEscaperContext(\n                    htmlStateCName,\n                    contextBefore.tagState,\n                    contextBefore.attribState,\n                    contextBefore.delimState,\n                  ),\n                  before.subsidiary,\n                ),\n              );\n            }\n          }\n        }\n        if (contextBefore.htmlState == htmlStatePcdata) {\n          let match: Match? = pattern13.find(literalPart) orelse null;\n          if (match != null) {\n            if ((pattern11.find(literalPart.slice(match.full.end, literalPart.end)) orelse null) != null) {\n              return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n                match.full.value,\n                match.full.end,\n                new AutoescState\u003cHtmlEscaperContext\u003e(\n                  new HtmlEscaperContext(\n                    htmlStateOName,\n                    contextBefore.tagState,\n                    contextBefore.attribState,\n                    contextBefore.delimState,\n                  ),\n                  before.subsidiary,\n                ),\n              );\n            }\n          }\n        }\n        if (contextBefore.htmlState == htmlStatePcdata) {\n          let match: Match? = pattern13.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              \u0022\u0026lt;\u0022,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStatePcdata) {\n          let match: Match? = pattern16.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              \u0022\u0026gt;\u0022,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStatePcdata) {\n          let match: Match? = pattern23.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateCName) {\n          let match: Match? = pattern1.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateCName) {\n          let match: Match? = pattern3.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateCName) {\n          let match: Match? = pattern26.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateCName) {\n          let match: Match? = pattern16.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStatePcdata,\n                  contextBefore.tagState,\n                  contextBefore.attribState,\n                  contextBefore.delimState,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateOName) {\n          let match: Match? = pattern28.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateOName) {\n          do {\n            if ((pattern4.find(literalPart) orelse null) != null) {\n              return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n                \u0022\u0022,\n                String.begin,\n                new AutoescState\u003cHtmlEscaperContext\u003e(\n                  new HtmlEscaperContext(\n                    htmlStateBeforeAttr,\n                    contextBefore.tagState,\n                    contextBefore.attribState,\n                    contextBefore.delimState,\n                  ),\n                  before.subsidiary,\n                ),\n              );\n            }\n          }\n        }\n        if (contextBefore.htmlState == htmlStateOName) {\n          let match: Match? = pattern20.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStateBeforeAttr,\n                  contextBefore.tagState,\n                  contextBefore.attribState,\n                  contextBefore.delimState,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeAttr) {\n          let match: Match? = pattern20.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeAttr) {\n          let match: Match? = pattern27.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeAttr) {\n          let match: Match? = pattern7.find(literalPart) orelse null;\n          if (match != null) {\n            if ((pattern6.find(literalPart.slice(match.full.end, literalPart.end)) orelse null) == null) {\n              return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n                match.full.value,\n                match.full.end,\n                new AutoescState\u003cHtmlEscaperContext\u003e(\n                  new HtmlEscaperContext(\n                    htmlStateBeforeEq,\n                    contextBefore.tagState,\n                    attribStateUrls,\n                    contextBefore.delimState,\n                  ),\n                  before.subsidiary,\n                ),\n              ).push(new HtmlUrlDelegate(), htmlCodec);\n            }\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeAttr) {\n          let match: Match? = pattern8.find(literalPart) orelse null;\n          if (match != null) {\n            if ((pattern6.find(literalPart.slice(match.full.end, literalPart.end)) orelse null) == null) {\n              return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n                match.full.value,\n                match.full.end,\n                new AutoescState\u003cHtmlEscaperContext\u003e(\n                  new HtmlEscaperContext(\n                    htmlStateBeforeEq,\n                    contextBefore.tagState,\n                    attribStateUrl,\n                    contextBefore.delimState,\n                  ),\n                  before.subsidiary,\n                ),\n              ).push(new HtmlUrlDelegate(), htmlCodec);\n            }\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeAttr) {\n          let match: Match? = pattern17.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStateBeforeEq,\n                  contextBefore.tagState,\n                  attribStateUrl,\n                  contextBefore.delimState,\n                ),\n                before.subsidiary,\n              ),\n            ).push(new HtmlUrlDelegate(), htmlCodec);\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeAttr) {\n          let match: Match? = pattern19.find(literalPart) orelse null;\n          if (match != null) {\n            if ((pattern6.find(literalPart.slice(match.full.end, literalPart.end)) orelse null) == null) {\n              return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n                match.full.value,\n                match.full.end,\n                new AutoescState\u003cHtmlEscaperContext\u003e(\n                  new HtmlEscaperContext(\n                    htmlStateBeforeEq,\n                    contextBefore.tagState,\n                    attribStateCss,\n                    contextBefore.delimState,\n                  ),\n                  before.subsidiary,\n                ),\n              ).push(new HtmlCssDelegate(), htmlCodec);\n            }\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeAttr) {\n          let match: Match? = pattern18.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStateBeforeEq,\n                  contextBefore.tagState,\n                  attribStateJs,\n                  contextBefore.delimState,\n                ),\n                before.subsidiary,\n              ),\n            ).push(new HtmlJsDelegate(),  htmlCodec);\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeAttr) {\n          let match: Match? = pattern24.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStateBeforeEq,\n                  contextBefore.tagState,\n                  contextBefore.attribState,\n                  contextBefore.delimState,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeEq) {\n          let match: Match? = pattern20.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeEq) {\n          let match: Match? = pattern15.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStateBeforeValue,\n                  contextBefore.tagState,\n                  contextBefore.attribState,\n                  contextBefore.delimState,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeEq) {\n          do {\n            if ((pattern9.find(literalPart) orelse null) != null) {\n              return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n                \u0022\u0022,\n                String.begin,\n                new AutoescState\u003cHtmlEscaperContext\u003e(\n                  new HtmlEscaperContext(\n                    htmlStateAfterAttr,\n                    contextBefore.tagState,\n                    contextBefore.attribState,\n                    contextBefore.delimState,\n                  ),\n                  before.subsidiary,\n                ),\n              );\n            }\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeValue) {\n          let match: Match? = pattern0.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStateAttr,\n                  contextBefore.tagState,\n                  contextBefore.attribState,\n                  delimStateDq,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeValue) {\n          let match: Match? = pattern2.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStateAttr,\n                  contextBefore.tagState,\n                  contextBefore.attribState,\n                  delimStateSq,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateBeforeValue) {\n          do {\n            if ((pattern10.find(literalPart) orelse null) != null) {\n              return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n                \u0022\\\u0022\u0022,\n                String.begin,\n                new AutoescState\u003cHtmlEscaperContext\u003e(\n                  new HtmlEscaperContext(\n                    htmlStateAttr,\n                    contextBefore.tagState,\n                    contextBefore.attribState,\n                    delimStateUq,\n                  ),\n                  before.subsidiary,\n                ),\n              );\n            }\n          }\n        }\n      }\n      if (literalPart == null \u0026\u0026 contextBefore.htmlState == htmlStateBeforeValue) {\n        do {\n          return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n            \u0022\\\u0022\u0022,\n            String.begin,\n            new AutoescState\u003cHtmlEscaperContext\u003e(\n              new HtmlEscaperContext(\n                htmlStateAttr,\n                contextBefore.tagState,\n                contextBefore.attribState,\n                delimStateUq,\n              ),\n              before.subsidiary,\n            ),\n          );\n        }\n      }\n      if (literalPart != null) {\n        if (contextBefore.htmlState == htmlStateAttr \u0026\u0026 contextBefore.delimState == delimStateUq) {\n          do {\n            if ((pattern5.find(literalPart) orelse null) != null) {\n              return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n                \u0022\\\u0022\u0022,\n                String.begin,\n                new AutoescState\u003cHtmlEscaperContext\u003e(\n                  new HtmlEscaperContext(\n                    htmlStateAfterAttr,\n                    contextBefore.tagState,\n                    contextBefore.attribState,\n                    delimStateUq,\n                  ),\n                  before.subsidiary,\n                ),\n              );\n            }\n          }\n        }\n        if (contextBefore.htmlState == htmlStateAttr \u0026\u0026 contextBefore.delimState == delimStateDq) {\n          let match: Match? = pattern0.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStateAfterAttr,\n                  contextBefore.tagState,\n                  contextBefore.attribState,\n                  delimStateUq,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateAttr \u0026\u0026 contextBefore.delimState == delimStateSq) {\n          let match: Match? = pattern2.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStateAfterAttr,\n                  contextBefore.tagState,\n                  contextBefore.attribState,\n                  delimStateUq,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.htmlState == htmlStateAttr \u0026\u0026 contextBefore.attribState == attribStateUrls) {\n          let match: Match? = pattern12.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            ).pop().push(new HtmlUrlDelegate(), htmlCodec);\n          }\n        }\n        if (contextBefore.htmlState == htmlStateAttr \u0026\u0026 contextBefore.delimState == delimStateUq) {\n          let match: Match? = pattern25.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            ).feed(false);\n          }\n        }\n        if (contextBefore.htmlState == htmlStateAttr \u0026\u0026 contextBefore.delimState == delimStateUq) {\n          let match: Match? = pattern0.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              \u0022\u0026#34;\u0022,\n              match.full.end,\n              before,\n            ).feed(false);\n          }\n        }\n        if (contextBefore.htmlState == htmlStateAttr \u0026\u0026 contextBefore.delimState == delimStateDq) {\n          let match: Match? = pattern21.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            ).feed(false);\n          }\n        }\n        if (contextBefore.htmlState == htmlStateAttr \u0026\u0026 contextBefore.delimState == delimStateSq) {\n          let match: Match? = pattern22.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            ).feed(false);\n          }\n        }\n      }\n      if (literalPart == null \u0026\u0026 contextBefore.htmlState == htmlStateAttr \u0026\u0026 contextBefore.attribState == attribStateGeneric) {\n        do {\n          return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n            \u0022\u0022,\n            String.begin,\n            before,\n          );\n        }\n      }\n      if (literalPart == null \u0026\u0026 contextBefore.htmlState == htmlStateAttr) {\n        do {\n          return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n            \u0022\u0022,\n            String.begin,\n            before,\n          ).feed(true);\n        }\n      }\n      if (contextBefore.htmlState == htmlStateAfterAttr \u0026\u0026 contextBefore.attribState == attribStateGeneric) {\n        do {\n          return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n            \u0022\u0022,\n            String.begin,\n            new AutoescState\u003cHtmlEscaperContext\u003e(\n              new HtmlEscaperContext(\n                htmlStateBeforeAttr,\n                contextBefore.tagState,\n                contextBefore.attribState,\n                contextBefore.delimState,\n              ),\n              before.subsidiary,\n            ),\n          );\n        }\n      }\n      if (contextBefore.htmlState == htmlStateAfterAttr) {\n        do {\n          return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n            \u0022\u0022,\n            String.begin,\n            new AutoescState\u003cHtmlEscaperContext\u003e(\n              new HtmlEscaperContext(\n                htmlStateBeforeAttr,\n                contextBefore.tagState,\n                attribStateGeneric,\n                contextBefore.delimState,\n              ),\n              before.subsidiary,\n            ),\n          ).pop();\n        }\n      }\n      if (literalPart != null) {\n        if (contextBefore.htmlState == htmlStateBeforeAttr) {\n          let match: Match? = pattern16.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cHtmlEscaperContext\u003e(\n                new HtmlEscaperContext(\n                  htmlStatePcdata,\n                  contextBefore.tagState,\n                  contextBefore.attribState,\n                  contextBefore.delimState,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n      }\n      if (literalPart == null) {\n        do {\n          return new AfterPropagate\u003cHtmlEscaperContext\u003e(\n            \u0022\u0022,\n            String.begin,\n            before,\n          );\n        }\n      }\n      panic()\n    }\n\n\u003c!-- /GENERATED_PROPAGATION_FN --\u003e\n\n    export class HtmlContextPropagator extends ContextPropagator\u003cHtmlEscaperContext\u003e {\n      public after(\n        before: AutoescState\u003cHtmlEscaperContext\u003e,\n        literalPart: String?,\n      ): AfterPropagate\u003cHtmlEscaperContext\u003e {\n        htmlPropagateContext(before, literalPart)\n      }\n    }\n\n\u003c!-- GENERATED_PROPAGATION_FN: Url --\u003e\n\n    let urlStateStr(x: Int32): String {\n      when (x) {\n        urlStateStart -\u003e \u0022Start\u0022;\n        urlStateBeforeQuery -\u003e \u0022BeforeQuery\u0022;\n        urlStateQuery -\u003e \u0022Query\u0022;\n        urlStateFragment -\u003e \u0022Fragment\u0022;\n        else -\u003e x.toString();\n      }\n    }\n    let urlPropagateContext(\n      before: AutoescState\u003cUrlEscaperContext\u003e,\n      literalPart: String?,\n    ): AfterPropagate\u003cUrlEscaperContext\u003e {\n      let contextBefore = before.context;\n      let pattern0: Regex = rgx\u0022^(?:[#])\u0022;\n      let pattern1: Regex = rgx\u0022^(?:[?])\u0022;\n      let pattern2: Regex = rgx\u0022^(?:[^#]+)\u0022;\n      let pattern3: Regex = rgx\u0022^(?:[^:#?]*:|[^\\t\\r\\n :#?])\u0022;\n      let pattern4: Regex = rgx\u0022^(?:[^?#]+)\u0022;\n      if (literalPart != null) {\n        if (contextBefore.urlState == urlStateStart) {\n          let match: Match? = pattern3.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cUrlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cUrlEscaperContext\u003e(\n                new UrlEscaperContext(\n                  urlStateBeforeQuery,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.urlState == urlStateStart) {\n          let match: Match? = pattern1.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cUrlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cUrlEscaperContext\u003e(\n                new UrlEscaperContext(\n                  urlStateQuery,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.urlState == urlStateStart) {\n          let match: Match? = pattern0.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cUrlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cUrlEscaperContext\u003e(\n                new UrlEscaperContext(\n                  urlStateFragment,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.urlState == urlStateBeforeQuery) {\n          let match: Match? = pattern4.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cUrlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.urlState == urlStateBeforeQuery) {\n          let match: Match? = pattern1.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cUrlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cUrlEscaperContext\u003e(\n                new UrlEscaperContext(\n                  urlStateQuery,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.urlState == urlStateBeforeQuery) {\n          let match: Match? = pattern0.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cUrlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cUrlEscaperContext\u003e(\n                new UrlEscaperContext(\n                  urlStateFragment,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n        if (contextBefore.urlState == urlStateQuery) {\n          let match: Match? = pattern2.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cUrlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              before,\n            );\n          }\n        }\n        if (contextBefore.urlState == urlStateQuery) {\n          let match: Match? = pattern0.find(literalPart) orelse null;\n          if (match != null) {\n            return new AfterPropagate\u003cUrlEscaperContext\u003e(\n              match.full.value,\n              match.full.end,\n              new AutoescState\u003cUrlEscaperContext\u003e(\n                new UrlEscaperContext(\n                  urlStateFragment,\n                ),\n                before.subsidiary,\n              ),\n            );\n          }\n        }\n      }\n      if (literalPart == null) {\n        do {\n          return new AfterPropagate\u003cUrlEscaperContext\u003e(\n            \u0022\u0022,\n            String.begin,\n            before,\n          );\n        }\n      }\n      panic()\n    }\n\n\u003c!-- /GENERATED_PROPAGATION_FN --\u003e\n\n    export class UrlContextPropagator extends ContextPropagator\u003cUrlEscaperContext\u003e {\n      public after(\n        before: AutoescState\u003cUrlEscaperContext\u003e,\n        literalPart: String?,\n      ): AfterPropagate\u003cUrlEscaperContext\u003e {\n        urlPropagateContext(before, literalPart)\n      }\n    }\n\n    let urlContextPropagator = new UrlContextPropagator();\n\n\u003c/details\u003e\n\n" ], "names": [ "after", "before", "literalPart", "htmlPropagateContext" ], "mappings": "AAorBiB,OAMV,EAAA,AANU,OAMV,CAAA,AANU,IAMV,CAAA;AANU,OAMV,EAAA,AANU,OAMV,CAAA,AANU,IAMV,CAAA;AANU,gBAMV,CAAA,AANU;AAMV,CAAA;AANU,gBAMV,AANU,yBAMV,EAAA,AANU,kBAMV,CAAA,AANU,kBAMV;AAAA,KAAA;AALM,cAGJ,AAJQ,EAMV,EAAA,AAFE,cAAkC,CAAA,AAAlC,kBAAkC,CAAA,AAH9B,CAAAA,KAAK,CACF,AAFC,CAMV,EAAA,AAJS,YAAgC,CAAA,AAAhC,kBAAgC,CAAA,AAAxC,CAAAC,WAAwC,CAC3B,OAAO,EAAA,AAApB,CAAAC,gBAAoB,CAGrB;AAFqC;AACpC,kBAAA,AALS,EAMV,EAAA,AADC,UAAoB,CAAA,AAApBC,yBAAoB,CAACF,WAAM,CAAE,CAAAC,gBAAW,CAAC;AAAA,SAC1C;AAN8E;AAAA;AAAA;AAAA;AAM9E" }